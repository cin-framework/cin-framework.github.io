function handleEmailSubmit(t){t.preventDefault();const e=t.target.querySelector('input[type="email"]').value,o=document.getElementById("subscriptionMessage");e&&e.includes("@")?(o.innerHTML="<strong>شكراً لك!</strong> تم تسجيل بريدك الإلكتروني بنجاح. سنتواصل معك عند إطلاق CIN Framework.",o.className="cin-alert cin-alert-success",o.style.display="block",t.target.reset()):(o.innerHTML="<strong>خطأ:</strong> يرجى إدخال بريد إلكتروني صحيح.",o.className="cin-alert cin-alert-error",o.style.display="block"),setTimeout((()=>{o.style.display="none"}),5e3)}window.onload=function(){const t=new THREE.Scene,e=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,4e3),o=new THREE.WebGLRenderer({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.shadowMap.enabled=!0,o.shadowMap.type=THREE.PCFSoftShadowMap,document.body.appendChild(o.domElement),e.position.z=130,e.position.y=5,t.background=new THREE.Color(3100),t.fog=new THREE.Fog(3100,100,800);const i=new THREE.AmbientLight(4210752,5);t.add(i);const a=new THREE.DirectionalLight(16777215,1);a.castShadow=!0,a.shadow.mapSize.width=2048,a.shadow.mapSize.height=2048,a.shadow.camera.near=1,a.shadow.camera.far=100,t.add(a);const n=new THREE.Mesh(new THREE.SphereGeometry(20,32,32),new THREE.MeshBasicMaterial({color:16773312,emissive:16773312}));t.add(n);const s=new THREE.PointLight(16773312,5e3,200);t.add(s);const r=new THREE.PointLight(15790335,.5,300);t.add(r);const l=(new THREE.TextureLoader).load("./assets/img/3D/earth_clouds_1024.png"),d=new THREE.Mesh(new THREE.SphereGeometry(10,32,32),new THREE.MeshStandardMaterial({map:l,color:16777215,emissive:16777215,emissiveIntensity:.5}));t.add(d);const c=new THREE.PlaneGeometry(2e3,2e3),p=new THREE.Water(c,{textureWidth:1024,textureHeight:1024,waterNormals:(new THREE.TextureLoader).load("./assets/img/3D/waternormals.jpg",(function(t){t.wrapS=t.wrapT=THREE.RepeatWrapping,t.repeat.set(10,10)})),alpha:1,sunDirection:a.position.clone().normalize(),sunColor:16777215,waterColor:1296,distortionScale:3.7,fog:void 0!==t.fog,side:THREE.DoubleSide});p.rotation.x=-Math.PI/2,p.position.y=-5,t.add(p);const h=new THREE.PlaneGeometry(2e3,2e3,100,100),m=((new THREE.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="),document.createElement("canvas"));m.width=512,m.height=512;const E=m.getContext("2d");for(let t=0;t<1e3;t++){const t=512*Math.random(),e=512*Math.random(),o=20*Math.random()+5,i=Math.floor(100*Math.random()+50);E.fillStyle=`rgb(${i}, ${i-10}, ${i-20})`,E.beginPath(),E.arc(t,e,o,0,2*Math.PI),E.fill()}const M=new THREE.CanvasTexture(m);M.wrapS=M.wrapT=THREE.RepeatWrapping,M.repeat.set(20,20);const y=new THREE.MeshStandardMaterial({map:M,color:2763306,metalness:.1,roughness:.9,normalScale:new THREE.Vector2(2,2)}),g=h.attributes.position;for(let t=0;t<g.count;t++){const e=g.getX(t),o=g.getZ(t),i=Math.sin(.01*e)*Math.cos(.01*o)*10+5*Math.random();g.setY(t,i)}g.needsUpdate=!0,h.computeVertexNormals();const w=new THREE.Mesh(h,y);w.rotation.x=-Math.PI/2,w.position.y=-200,w.receiveShadow=!0,t.add(w);const u=[],T=[];for(let e=0;e<15;e++){const e=new THREE.Group,o=new THREE.CylinderGeometry(.3,.8,3,8),i=new THREE.MeshStandardMaterial({color:(new THREE.Color).setHSL(.6*Math.random()+.1,.8,.6),metalness:.3,roughness:.4,transparent:!0,opacity:.9}),a=new THREE.Mesh(o,i);a.rotation.z=Math.PI/2;const n=new THREE.ConeGeometry(.8,1.5,6),s=new THREE.MeshStandardMaterial({color:i.color.clone().multiplyScalar(.8),metalness:.2,roughness:.5,transparent:!0,opacity:.8}),r=new THREE.Mesh(n,s);r.position.set(-2,0,0),r.rotation.z=Math.PI/2;const l=new THREE.PlaneGeometry(.8,.4),d=new THREE.MeshStandardMaterial({color:i.color.clone().multiplyScalar(.7),transparent:!0,opacity:.7,side:THREE.DoubleSide}),c=new THREE.Mesh(l,d);c.position.set(0,.8,0),c.rotation.x=Math.PI/6;const p=new THREE.Mesh(l,d);p.position.set(0,-.8,0),p.rotation.x=-Math.PI/6;const h=new THREE.Mesh(l,d);h.position.set(.5,0,.6),h.rotation.y=Math.PI/4;const m=new THREE.Mesh(l,d);m.position.set(.5,0,-.6),m.rotation.y=-Math.PI/4,e.add(a),e.add(r),e.add(c),e.add(p),e.add(h),e.add(m);const E=e;E.position.set(300*(Math.random()-.5),-10-80*Math.random(),300*(Math.random()-.5)),E.userData={velocity:new THREE.Vector3(.3*(Math.random()-.5),.1*(Math.random()-.5),.3*(Math.random()-.5)),swimSpeed:.02*Math.random()+.01,swimTime:Math.random()*Math.PI*2,originalY:E.position.y,jumpCooldown:0,isJumping:!1,jumpVelocity:0,jumpHeight:0,jumpPhase:"ascending",isHeadUp:!1,headUpTime:0,headCooldown:0,targetY:E.position.y,tailSwim:Math.random()*Math.PI*2,finSwim:Math.random()*Math.PI*2,body:a,tail:r,topFin:c,bottomFin:p,sideFin1:h,sideFin2:m},T.push(E),t.add(E)}for(let e=0;e<30;e++){const e=new THREE.SphereGeometry(.5,8,6),o=new THREE.MeshBasicMaterial({color:(new THREE.Color).setHSL(.3*Math.random()+.1,1,.8),emissive:(new THREE.Color).setHSL(.3*Math.random()+.1,1,.5),transparent:!0,opacity:.8}),i=new THREE.Mesh(e,o);i.position.set(400*(Math.random()-.5),-20-150*Math.random(),400*(Math.random()-.5));const a=new THREE.PointLight(o.color.getHex(),2,20);a.position.copy(i.position),t.add(a),i.userData={light:a,velocity:new THREE.Vector3(.1*(Math.random()-.5),.05*(Math.random()-.5),.1*(Math.random()-.5)),originalY:i.position.y,time:Math.random()*Math.PI*2,speed:.02*Math.random()+.01},u.push(i),t.add(i)}const H=new THREE.BufferGeometry,R=new Float32Array(6e4);for(let t=0;t<6e4;t+=3)R[t]=800*(Math.random()-.5),R[t+1]=800*Math.random(),R[t+2]=800*(Math.random()-.5);H.setAttribute("position",new THREE.BufferAttribute(R,3));const f=new THREE.PointsMaterial({color:16777215,size:.2,transparent:!0,opacity:.8}),S=new THREE.Points(H,f);t.add(S);const b=[],v=[],x=[{size:8,leader:null,formation:"V"},{size:5,leader:null,formation:"line"},{size:3,leader:null,formation:"triangle"}];for(let e=0;e<25;e++){const o=new THREE.Group,i=new THREE.ConeGeometry(.3,1.5,4),a=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.8}),n=new THREE.Mesh(i,a),s=new THREE.PlaneGeometry(1,.5),r=new THREE.MeshBasicMaterial({color:1710618,transparent:!0,opacity:.7,side:THREE.DoubleSide}),l=new THREE.Mesh(s,r);l.position.set(.6,0,0),l.rotation.y=Math.PI/6;const d=new THREE.PlaneGeometry(1,.5),c=new THREE.MeshBasicMaterial({color:1710618,transparent:!0,opacity:.7,side:THREE.DoubleSide}),p=new THREE.Mesh(d,c);p.position.set(-.6,0,0),p.rotation.y=-Math.PI/6,o.add(n),o.add(l),o.add(p);const h=o;h.position.set(800*(Math.random()-.5),50+100*Math.random(),800*(Math.random()-.5));const m=e<16;let E=-1,M=-1;m&&(e<8?(E=0,M=e):e<13?(E=1,M=e-8):(E=2,M=e-13),0===M&&(x[E].leader=h)),h.userData={velocity:new THREE.Vector3(.2*(Math.random()-.5),.05*(Math.random()-.5),.2*(Math.random()-.5)),wingBeat:Math.random()*Math.PI*2,wingSpeed:.3*Math.random()+.2,isFlocking:m,flockIndex:E,positionInFlock:M,baseSpeed:.1*Math.random()+.05,turnSpeed:.02*Math.random()+.01,rightWing:l,leftWing:p,body:n,approachDistance:100*Math.random()+50,approachSpeed:.02*Math.random()+.01,isApproaching:Math.random()<.5,originalScale:1,targetScale:.5*Math.random()+.5},b.push(h),t.add(h)}for(let e=0;e<8;e++){const e=new THREE.Group,o=new THREE.ConeGeometry(1.2,4,6),i=new THREE.MeshBasicMaterial({color:1710618,transparent:!0,opacity:.9}),a=new THREE.Mesh(o,i),n=new THREE.PlaneGeometry(3,1.5),s=new THREE.MeshBasicMaterial({color:855309,transparent:!0,opacity:.8,side:THREE.DoubleSide}),r=new THREE.Mesh(n,s);r.position.set(2,0,0),r.rotation.y=Math.PI/4;const l=new THREE.PlaneGeometry(3,1.5),d=new THREE.MeshBasicMaterial({color:855309,transparent:!0,opacity:.8,side:THREE.DoubleSide}),c=new THREE.Mesh(l,d);c.position.set(-2,0,0),c.rotation.y=-Math.PI/4,e.add(a),e.add(r),e.add(c);const p=e;p.position.set(1e3*(Math.random()-.5),80+150*Math.random(),1e3*(Math.random()-.5)),p.userData={velocity:new THREE.Vector3(.15*(Math.random()-.5),.03*(Math.random()-.5),.15*(Math.random()-.5)),wingBeat:Math.random()*Math.PI*2,wingSpeed:.15*Math.random()+.1,glideTime:200*Math.random()+100,glideCounter:0,isGliding:Math.random()<.5,circleRadius:50*Math.random()+30,circleAngle:Math.random()*Math.PI*2,circleSpeed:.01*Math.random()+.005,baseSpeed:.08*Math.random()+.04,rightWing:r,leftWing:c,body:a,approachDistance:150*Math.random()+100,approachSpeed:.015*Math.random()+.008,isApproaching:Math.random()<.5,originalScale:1,targetScale:.7*Math.random()+.4},v.push(p),t.add(p)}let A,P;(new THREE.FontLoader).load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",(function(e){P=e;const o=new THREE.TextGeometry("CIN FRAMEWORK",{font:P,size:8,height:1,curveSegments:12,bevelEnabled:!0,bevelThickness:.5,bevelSize:.5,bevelOffset:0,bevelSegments:5});o.center();const i=new THREE.MeshPhongMaterial({color:43775,emissive:22015,specular:43775});A=new THREE.Mesh(o,i),A.position.y=20,t.add(A)}));const C=document.getElementById("content-wrapper"),z=C.querySelector(".content-inner");let I=!1;const D=function(i){requestAnimationFrame(D);const l=.001*Date.now();if(A){const t=.05*l%1;A.material.color.setHSL(t,1,.5),A.material.emissive.setHSL(t,1,.5),A.position.y=20+.5*Math.sin(l),A.rotation.y+=.005}const c=400,h=.1*l%(2*Math.PI);n.position.x=Math.sin(h)*c,n.position.y=Math.cos(h)*c,n.position.z=100*Math.sin(h),d.position.x=-Math.sin(h)*c,d.position.y=-Math.cos(h)*c,d.position.z=100*-Math.sin(h);const m=n.position.y;a.position.copy(n.position),s.position.copy(n.position),r.position.copy(d.position);let E=Math.max(0,m/c);m<0&&(E=0),a.intensity=20*E,s.intensity=5e3*E,r.intensity=.5*(1-E);const M=new THREE.Color(4620980),y=new THREE.Color(3100),g=new THREE.Color;g.copy(y).lerp(M,E),I||(t.background=g,t.fog.color=g),S.rotation.y+=.001,S.material.opacity=1-E,T.forEach(((e,o)=>{const i=e.userData;if(i.swimTime+=i.swimSpeed,i.tailSwim+=.15,i.tail.rotation.y=.3*Math.sin(i.tailSwim),i.finSwim+=.1,i.topFin.rotation.z=.2*Math.sin(i.finSwim),i.bottomFin.rotation.z=.2*-Math.sin(i.finSwim),i.sideFin1.rotation.x=.15*Math.sin(.8*i.finSwim),i.sideFin2.rotation.x=.15*-Math.sin(.8*i.finSwim),i.body.position.y=.1*Math.sin(2*i.swimTime),e.position.add(i.velocity),e.position.y=i.originalY+2*Math.sin(i.swimTime),Math.random()<.005&&(i.velocity.x+=.02*(Math.random()-.5),i.velocity.z+=.02*(Math.random()-.5),i.velocity.normalize().multiplyScalar(.1)),!i.isHeadUp&&i.headCooldown<=0&&Math.random()<.001&&(i.isHeadUp=!0,i.headUpTime=60+40*Math.random(),i.headCooldown=400+300*Math.random(),i.targetY=-2),i.isHeadUp?(e.position.y=THREE.MathUtils.lerp(e.position.y,i.targetY,.05),i.headUpTime--,i.headUpTime<=0&&(i.isHeadUp=!1,i.targetY=i.originalY)):(e.position.y>i.originalY&&(e.position.y=THREE.MathUtils.lerp(e.position.y,i.originalY+2*Math.sin(i.swimTime),.03)),i.headCooldown--),!i.isJumping&&!i.isHeadUp&&i.jumpCooldown<=0&&Math.random()<2e-4){i.isJumping=!0,i.jumpVelocity=.8+.4*Math.random(),i.jumpHeight=e.position.y,i.jumpCooldown=500+400*Math.random(),i.jumpPhase="ascending";((e,o,i=1)=>{for(let i=0;i<3;i++){const a=new THREE.Mesh(new THREE.RingGeometry(.2+.3*i,.5+.4*i,16),new THREE.MeshBasicMaterial({color:4886754,transparent:!0,opacity:.4-.1*i,side:THREE.DoubleSide}));a.position.set(e,-4.9,o),a.rotation.x=-Math.PI/2,t.add(a);setTimeout((()=>{const e=()=>{a.scale.multiplyScalar(1.02),a.material.opacity*=.98,a.material.opacity>.01&&a.scale.x<8?requestAnimationFrame(e):t.remove(a)};e()}),100*i)}})(e.position.x,e.position.z)}if(i.isJumping){if("ascending"===i.jumpPhase)e.position.y+=i.jumpVelocity,i.jumpVelocity-=.02,e.rotation.x=-Math.PI/6,i.jumpVelocity<=0&&(i.jumpPhase="descending");else if("descending"===i.jumpPhase&&(e.position.y+=i.jumpVelocity,i.jumpVelocity-=.02,e.rotation.x=Math.PI/6,e.position.y<=i.originalY)){i.isJumping=!1,e.position.y=i.originalY,e.rotation.x=0;((e,o)=>{for(let i=0;i<2;i++){const a=new THREE.Mesh(new THREE.RingGeometry(.1+.2*i,.4+.3*i,12),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.6-.2*i,side:THREE.DoubleSide}));a.position.set(e,-4.9,o),a.rotation.x=-Math.PI/2,t.add(a);const n=()=>{a.scale.multiplyScalar(1.05),a.material.opacity*=.94,a.material.opacity>.01&&a.scale.x<6?requestAnimationFrame(n):t.remove(a)};n()}})(e.position.x,e.position.z)}}else i.jumpCooldown--;if(!i.isJumping){const t=i.velocity.clone().normalize();e.lookAt(e.position.clone().add(t))}(Math.abs(e.position.x)>400||Math.abs(e.position.z)>400)&&e.position.set(300*(Math.random()-.5),i.originalY,300*(Math.random()-.5))})),u.forEach((t=>{t.userData.time+=t.userData.speed,t.position.add(t.userData.velocity),t.position.y=t.userData.originalY+5*Math.sin(t.userData.time),Math.random()<.02&&t.userData.velocity.set(.1*(Math.random()-.5),.05*(Math.random()-.5),.1*(Math.random()-.5)),t.position.x>200&&(t.position.x=-200),t.position.x<-200&&(t.position.x=200),t.position.z>200&&(t.position.z=-200),t.position.z<-200&&(t.position.z=200),t.position.y>-10&&(t.position.y=-170),t.position.y<-180&&(t.position.y=-20),t.userData.light.position.copy(t.position);const e=.8+.2*Math.sin(3*t.userData.time);t.userData.light.intensity=2*e,t.material.opacity=.6+.2*e})),E>.3?b.forEach(((t,e)=>{const o=t.userData;o.wingBeat+=o.wingSpeed;const i=Math.sin(o.wingBeat);o.rightWing.rotation.z=.8*i,o.rightWing.rotation.x=.3*i,o.leftWing.rotation.z=.8*-i,o.leftWing.rotation.x=.3*i,o.body.rotation.x=.05*Math.sin(.5*o.wingBeat),o.isApproaching?(o.targetScale+=o.approachSpeed,o.targetScale>1.5&&(o.isApproaching=!1)):(o.targetScale-=o.approachSpeed,o.targetScale<.3&&(o.isApproaching=!0)),t.scale.setScalar(o.targetScale);const a=Math.max(.3,o.targetScale);if(o.body.material.opacity=.8*E*a,o.rightWing.material.opacity=.7*E*a,o.leftWing.material.opacity=.7*E*a,o.isFlocking&&-1!==o.flockIndex){const e=x[o.flockIndex],i=e.leader;if(0===o.positionInFlock)t.position.add(o.velocity),Math.random()<.005&&o.velocity.set(.3*(Math.random()-.5),.1*(Math.random()-.5),.3*(Math.random()-.5));else if(i){const a=i.position.clone();if("V"===e.formation){const t=o.positionInFlock%2==0?1:-1,e=Math.floor(o.positionInFlock/2)+1;a.x+=t*e*8,a.z-=5*e}else"line"===e.formation?a.x+=6*(o.positionInFlock-2):"triangle"===e.formation&&(1===o.positionInFlock?(a.x-=4,a.z-=3):(a.x+=4,a.z-=3));const n=a.sub(t.position).normalize();t.position.add(n.multiplyScalar(o.baseSpeed))}}else t.position.add(o.velocity),Math.random()<.01&&o.velocity.set(.2*(Math.random()-.5),.05*(Math.random()-.5),.2*(Math.random()-.5));o.velocity.length()>0&&t.lookAt(t.position.clone().add(o.velocity)),(Math.abs(t.position.x)>400||Math.abs(t.position.z)>400||t.position.y<30||t.position.y>200)&&t.position.set(600*(Math.random()-.5),50+100*Math.random(),600*(Math.random()-.5))})):b.forEach((t=>{const e=t.userData;e.body.material.opacity=0,e.rightWing.material.opacity=0,e.leftWing.material.opacity=0})),E>.3?v.forEach(((t,e)=>{const o=t.userData;if(o.isApproaching?(o.targetScale+=o.approachSpeed,o.targetScale>1.8&&(o.isApproaching=!1)):(o.targetScale-=o.approachSpeed,o.targetScale<.2&&(o.isApproaching=!0)),t.scale.setScalar(o.targetScale),o.isGliding){o.glideCounter++,o.circleAngle+=o.circleSpeed;const e=Math.cos(o.circleAngle)*o.circleRadius,i=Math.sin(o.circleAngle)*o.circleRadius;t.position.x+=.01*e,t.position.z+=.01*i,t.position.y+=.02*Math.sin(.5*o.circleAngle),o.wingBeat+=.2*o.wingSpeed;const a=Math.sin(.1*o.wingBeat);o.rightWing.rotation.z=.1*a,o.rightWing.rotation.x=.05*a-.2,o.leftWing.rotation.z=.1*-a,o.leftWing.rotation.x=.05*a-.2,o.glideCounter>o.glideTime&&(o.isGliding=!1,o.glideCounter=0,o.glideTime=300*Math.random()+150)}else{o.glideCounter++,o.wingBeat+=o.wingSpeed;const e=Math.sin(o.wingBeat);o.rightWing.rotation.z=.6*e,o.rightWing.rotation.x=.2*e,o.leftWing.rotation.z=.6*-e,o.leftWing.rotation.x=.2*e,o.body.rotation.x=.03*Math.sin(.3*o.wingBeat),t.position.add(o.velocity),Math.random()<.003&&o.velocity.set(.2*(Math.random()-.5),.05*(Math.random()-.5),.2*(Math.random()-.5)),o.glideCounter>.5*o.glideTime&&(o.isGliding=!0,o.glideCounter=0)}o.velocity.length()>0&&t.lookAt(t.position.clone().add(o.velocity)),(Math.abs(t.position.x)>500||Math.abs(t.position.z)>500||t.position.y<60||t.position.y>300)&&t.position.set(800*(Math.random()-.5),80+150*Math.random(),800*(Math.random()-.5));const i=Math.max(.2,o.targetScale);o.body.material.opacity=.9*E*i,o.rightWing.material.opacity=.8*E*i,o.leftWing.material.opacity=.8*E*i})):v.forEach((t=>{const e=t.userData;e.body.material.opacity=0,e.rightWing.material.opacity=0,e.leftWing.material.opacity=0})),p.material.uniforms.time.value+=1/60,p.material.uniforms.sunDirection.value.copy(a.position).normalize(),o.render(t,e)};function W(){const t=document.getElementById("surfaceBtn"),o=t.querySelector(".material-symbols-rounded");e.position.y>5?(o.textContent="keyboard_double_arrow_down",t.title="الغوص في الأعماق",U=2):e.position.y>-40?(o.textContent="keyboard_double_arrow_up",t.title="الصعود للسطح",U=1):(o.textContent="keyboard_double_arrow_up",t.title="العودة للعمق المتوسط",U=0)}function k(o){e.position.y-=.1*o,e.position.y=Math.min(5,Math.max(-100,e.position.y));const l=e.position.y<-5,c=Math.max(0,Math.min(1,(5-e.position.y)/10));if(W(),l!==I)if(I=l,I){t.background.set(5),t.fog.color.set(5),i.intensity=.5,p.material.uniforms.distortionScale.value=8,n.visible=!1,d.visible=!1,a.intensity=0,s.intensity=0,r.intensity=0,A&&(A.visible=!1),C.style.display="flex";C.querySelectorAll(".underwater-card").forEach(((t,e)=>{t.style.transform=`translateY(${100-100*c}px)`,t.style.opacity=c,t.style.transition="transform 0.3s ease-out, opacity 0.3s ease-out"}))}else{const e=new THREE.Color(4620980),o=new THREE.Color(3100),l=new THREE.Color,c=Math.max(0,n.position.y/400);l.copy(o).lerp(e,c),t.background.set(l),t.fog.color.set(l),i.intensity=5,p.material.uniforms.distortionScale.value=3.7,n.visible=!0,d.visible=!0,a.intensity=20*c,s.intensity=5e3*c,r.intensity=.5*(1-c),A&&(A.visible=!0),C.style.display="none"}if(I){C.querySelectorAll(".underwater-card").forEach(((t,o)=>{const i=-15-20*o,a=Math.max(0,Math.min(1,(-e.position.y-i+10)/15));t.style.transform=`translateY(${50-50*a}px)`,t.style.opacity=a}))}}window.addEventListener("wheel",(t=>{k(t.deltaY)}));let B=0;window.addEventListener("touchstart",(t=>{B=t.touches[0].clientY})),window.addEventListener("touchmove",(t=>{t.preventDefault();k(B-t.touches[0].clientY),B=t.touches[0].clientY}),{passive:!1});let F=0,G=0,L=0,Y=!1,j=null;z.addEventListener("touchstart",(t=>{F=t.touches[0].clientY,G=F,L=0,Y=!0,j&&(cancelAnimationFrame(j),j=null)}),{passive:!0}),z.addEventListener("touchmove",(t=>{if(Y){const e=t.touches[0].clientY;L=2.5*(G-e),z.scrollTop+=L,G=e}}),{passive:!0}),z.addEventListener("touchend",(()=>{if(Y=!1,Math.abs(L)>5){const t=()=>{L*=.95,z.scrollTop+=L,j=Math.abs(L)>1?requestAnimationFrame(t):null};j=requestAnimationFrame(t)}}),{passive:!0}),window.addEventListener("resize",(()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)})),D(performance.now());let U=1;W(),document.getElementById("surfaceBtn").addEventListener("click",(function(){const o=document.getElementById("content-wrapper");let l;e.position.y>5?l=-30:e.position.y>-40?(l=10,o.style.display="none"):l=-30;const c=e.position.y,h=Date.now(),m=()=>{const E=Date.now()-h,M=Math.min(E/2e3,1),y=1-Math.pow(1-M,3);e.position.y=c+(l-c)*y,W();const g=e.position.y<-5;if(g!==I)if(I=g,I)t.background.set(5),t.fog.color.set(5),i.intensity=.5,p.material.uniforms.distortionScale.value=8,n.visible=!1,d.visible=!1,a.intensity=0,s.intensity=0,r.intensity=0,A&&(A.visible=!1);else{const e=new THREE.Color(4620980),o=new THREE.Color(3100),l=new THREE.Color,c=Math.max(0,n.position.y/400);l.copy(o).lerp(e,c),t.background.set(l),t.fog.color.set(l),i.intensity=5,p.material.uniforms.distortionScale.value=3.7,n.visible=!0,d.visible=!0,a.intensity=20*c,s.intensity=5e3*c,r.intensity=.5*(1-c),A&&(A.visible=!0)}M<1?requestAnimationFrame(m):e.position.y<5&&(o.style.display="flex")};m()}))};